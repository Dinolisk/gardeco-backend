{
  "info": {
    "name": "Gardeco Backend API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Step 1: Create Transaction",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/transaction",
          "host": ["{{baseUrl}}"],
          "path": ["api", "transaction"]
        },
        "body": {
          "mode": "raw",
          "raw": {
            "cardId": "550e8400-e29b-41d4-a716-446655440000",
            "transactionData": {
              "schemaVersion": "V1.0",
              "merchantName": "Test Store",
              "acquirerTerminalId": "123456789012345",
              "acquirerTransactionTimestamp": "2024-04-23T13:37:00Z",
              "transactionAmount": {
                "merchantTransactionAmount": 100.00,
                "merchantTransactionCurrency": "NOK"
              },
              "transactionIdentifier": {
                "authorizationCode": "123456",
                "systemTraceAuditNumber": "123456",
                "retrievalReferenceNumber": "123456789012"
              },
              "paymentCard": {
                "cardType": "VISA",
                "maskedPan": [
                  {
                    "maskedPanType": "PRIMARY_PAN",
                    "maskedPanValue": "************1234"
                  }
                ]
              },
              "generalInformation": {
                "receiptNumber": "123456",
                "receiptTimestamp": "2024-04-23T13:37:00Z",
                "receiptType": "SALE",
                "receiptStatus": "COMPLETED"
              },
              "merchant": {
                "merchantName": "Test Store",
                "merchantId": "123456789",
                "merchantAddress": {
                  "street": "Testgatan 1",
                  "city": "Stockholm",
                  "postalCode": "12345",
                  "country": "SE"
                }
              },
              "branch": {
                "branchName": "Test Branch",
                "branchId": "BR123",
                "branchAddress": {
                  "street": "Testgatan 1",
                  "city": "Stockholm",
                  "postalCode": "12345",
                  "country": "SE"
                }
              },
              "line_items": [
                {
                  "itemName": "Test Product 1",
                  "itemDescription": "Test Description 1",
                  "itemPrice": {
                    "priceIncVat": "100.00",
                    "priceExcVat": "80.00",
                    "vatAmount": "20.00",
                    "vatRate": "25.00"
                  },
                  "quantity": "1.000",
                  "quantityType": "PCS",
                  "itemSumTotal": "100.00",
                  "itemIds": {
                    "id": "PROD001",
                    "ean": "1234567890123"
                  }
                }
              ],
              "order_summary": {
                "totalAmountIncVat": "100.00",
                "totalAmountExcVat": "80.00",
                "vatSummary": [
                  {
                    "vatRate": "25.00",
                    "vatAmount": "20.00",
                    "amountExcVat": "80.00"
                  }
                ]
              }
            }
          }
        }
      }
    },
    {
      "name": "Step 2: XReceipt Transaction Check (Matching)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/transaction/check",
          "host": ["{{baseUrl}}"],
          "path": ["api", "transaction", "check"]
        },
        "body": {
          "mode": "raw",
          "raw": {
            "schemaVersion": "V1.0",
            "xReceipts": {
              "clientId": "123456789",
              "roundTripId": "123e4567-e89b-12d3-a456-426614174000",
              "cardId": "550e8400-e29b-41d4-a716-446655440000",
              "cardholderConsents": [
                {
                  "consentId": "e521cf62-a45f-49c5-8372-94853fffeb55",
                  "consentType": "DIGITAL_RECEIPT",
                  "consentStatus": true
                }
              ],
              "cardholderMemberships": [
                {
                  "memberValue": "12345678",
                  "memberValueType": "MEMBER_NUMBER",
                  "memberValueProvider": "OBOS"
                }
              ]
            },
            "merchantName": "Test Store",
            "acquirerTerminalId": "123456789012345",
            "acquirerTransactionTimestamp": "2024-04-23T13:37:00Z",
            "transactionAmount": {
              "merchantTransactionAmount": 100.00,
              "merchantTransactionCurrency": "NOK",
              "cardholderTransactionAmount": 100.00,
              "cardholderTransactionCurrency": "NOK"
            },
            "transactionIdentifier": {
              "authorizationCode": "123456",
              "systemTraceAuditNumber": "123456",
              "retrievalReferenceNumber": "123456789012"
            },
            "paymentCard": {
              "cardType": "VISA",
              "maskedPan": [
                {
                  "maskedPanType": "PRIMARY_PAN",
                  "maskedPanValue": "************1234"
                }
              ]
            }
          }
        }
      }
    },
    {
      "name": "Step 3: Get Digital Receipt",
      "request": {
        "method": "GET",
        "url": {
          "raw": "{{baseUrl}}/api/transaction/receipt?transactionId={{transactionId}}",
          "host": ["{{baseUrl}}"],
          "path": ["api", "transaction", "receipt"],
          "query": [
            {
              "key": "transactionId",
              "value": "{{transactionId}}"
            }
          ]
        }
      }
    }
  ]
} 